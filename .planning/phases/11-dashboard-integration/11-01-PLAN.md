---
phase: 11-dashboard-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/dashboard/src/components/ui/tabs.tsx
  - apps/dashboard/src/components/wallet-dropdown.tsx
  - apps/dashboard/src/components/auth/auth-provider.tsx
  - apps/dashboard/src/lib/api.ts
autonomous: true

must_haves:
  truths:
    - "User can see Rewards link in wallet dropdown menu"
    - "Badge appears on Rewards link when user has claimable rewards"
    - "Tabs UI component exists for use in rewards dashboard"
  artifacts:
    - path: "apps/dashboard/src/components/ui/tabs.tsx"
      provides: "Radix Tabs UI wrapper"
      exports: ["Tabs", "TabsList", "TabsTrigger", "TabsContent"]
    - path: "apps/dashboard/src/components/wallet-dropdown.tsx"
      provides: "Rewards link with claimable badge"
      contains: "Rewards"
    - path: "apps/dashboard/src/components/auth/auth-provider.tsx"
      provides: "hasClaimable state in auth context"
      contains: "hasClaimable"
  key_links:
    - from: "auth-provider.tsx"
      to: "/api/rewards/claims/pending"
      via: "fetch in fetchRewardsStatus"
      pattern: "hasClaimable"
    - from: "wallet-dropdown.tsx"
      to: "auth-provider.tsx"
      via: "useAuth().hasClaimable"
      pattern: "hasClaimable && "
---

<objective>
Create the foundation components for rewards dashboard integration: Radix Tabs UI wrapper and navigation entry point with claimable badge indicator.

Purpose: Enable tabbed interface pattern and provide users easy access to rewards from anywhere in the dashboard.
Output: Tabs component in ui folder, Rewards link in WalletDropdown with dynamic badge state.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-dashboard-integration/11-CONTEXT.md
@.planning/phases/11-dashboard-integration/11-RESEARCH.md

# Existing files to modify
@apps/dashboard/src/components/wallet-dropdown.tsx
@apps/dashboard/src/components/auth/auth-provider.tsx
@apps/dashboard/src/lib/api.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Tabs UI component</name>
  <files>apps/dashboard/src/components/ui/tabs.tsx</files>
  <action>
Create Radix Tabs UI wrapper following shadcn/ui pattern (matches existing ui components style).

Export: Tabs, TabsList, TabsTrigger, TabsContent

TabsList styling:
- inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground

TabsTrigger styling:
- inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium
- ring-offset-background transition-all
- focus-visible: outline-none, ring-2, ring-ring, ring-offset-2
- disabled: pointer-events-none, opacity-50
- data-[state=active]: bg-background, text-foreground, shadow-sm

TabsContent styling:
- mt-2 ring-offset-background
- focus-visible: outline-none, ring-2, ring-ring, ring-offset-2

Use cn() from @/lib/utils for class merging. Mark as 'use client'.
  </action>
  <verify>File exists and exports all 4 components. TypeScript compiles without errors.</verify>
  <done>Tabs, TabsList, TabsTrigger, TabsContent are exported from tabs.tsx</done>
</task>

<task type="auto">
  <name>Task 2: Add hasClaimable state to auth context</name>
  <files>apps/dashboard/src/components/auth/auth-provider.tsx, apps/dashboard/src/lib/api.ts</files>
  <action>
1. In api.ts, add a new method to check for pending/claimable rewards:

```typescript
async getClaimableCampaigns(): Promise<{ hasClaimable: boolean }> {
  return this.request('/api/rewards/claims/pending');
}
```

Actually, simpler approach: extend the existing getRewardsStatus endpoint to include hasClaimable. But that requires backend change.

Alternative approach - derive from existing data in auth-provider.tsx:
- After fetching rewardsStatus, also fetch active campaign and claim status
- Set hasClaimable = true if claim exists with status 'pending' or if eligible but unclaimed

Simplest approach for now (no backend change): Add hasClaimable to AuthContextType, default false. In fetchRewardsStatus, after getting status, also fetch active campaign and check eligibility. This is optional - badge can be added later when backend supports it.

For this task: Add hasClaimable to auth context, derive it by checking:
1. Fetch active campaign (already have api.getActiveCampaign())
2. If campaign ended + user enrolled, call api.getClaimEligibility(campaignId)
3. Set hasClaimable = eligible && (claim is null OR claim.status === 'pending')

Update AuthContextType interface to add hasClaimable: boolean.
Update AuthContext default value to include hasClaimable: false.
Update AuthProvider to compute hasClaimable after fetching rewards status.
  </action>
  <verify>TypeScript compiles. useAuth() returns hasClaimable property. Console log in dev shows hasClaimable value.</verify>
  <done>hasClaimable is available from useAuth() hook and correctly reflects claimable state</done>
</task>

<task type="auto">
  <name>Task 3: Add Rewards link to WalletDropdown</name>
  <files>apps/dashboard/src/components/wallet-dropdown.tsx</files>
  <action>
Add Rewards link to WalletDropdown between Dashboard link and Billing Wallet section.

1. Import Trophy icon from lucide-react
2. Import useAuth, destructure hasClaimable
3. Add Rewards link after Dashboard link section:

```tsx
{/* Rewards Link */}
<div className="border-t border-border" />
<div className="p-2">
  <Link
    href="/rewards"
    className="flex items-center gap-2 w-full px-3 py-2.5 text-sm rounded-md hover:bg-muted/50 transition-colors relative"
  >
    <Trophy className="w-4 h-4 shrink-0" />
    Rewards
    {hasClaimable && (
      <span className="absolute right-3 w-2 h-2 bg-green-500 rounded-full animate-pulse" />
    )}
  </Link>
</div>
```

Note: Always show Rewards link (not conditional on isOnDashboard like Dashboard link).
Badge appears when hasClaimable is true - green pulse dot indicating action needed.
  </action>
  <verify>Visit dashboard, open wallet dropdown, see Rewards link with Trophy icon. Badge appears only when claimable.</verify>
  <done>Rewards link visible in WalletDropdown with Trophy icon and claimable badge</done>
</task>

</tasks>

<verification>
1. `npm run build` in apps/dashboard succeeds
2. Tabs component exports correctly: `import { Tabs, TabsList, TabsTrigger, TabsContent } from '@/components/ui/tabs'`
3. WalletDropdown shows Rewards link
4. useAuth() includes hasClaimable property
</verification>

<success_criteria>
- Tabs UI component created and matches project styling patterns
- Rewards link appears in WalletDropdown for authenticated users
- Badge indicator appears when user has claimable rewards (or always hidden if no claimable mechanism yet)
- No TypeScript errors, build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/11-dashboard-integration/11-01-SUMMARY.md`
</output>
